<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>TelegramStorage</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <nav class="navbar sticky-top bg-dark" data-bs-theme="dark">
        <div class="container-fluid">

          <a class="navbar-brand noselect">TelegramStorage</a>
          {% if register %}
          <div class="center">
            <form class="d-flex" role="search" action="query" method="POST">
              <input class="form-control me-2" name="query" id="query" type="search" placeholder="–ü–æ–∏—Å–∫" aria-label="–ü–æ–∏—Å–∫">
              <button class="btn btn-dark" type="submit">–ü–æ–∏—Å–∫</button>
            </form>
          </div>
          {% endif %}

          <div>

            {% if not register %}
            <a href="{{ url_for('register') }}">
            <button class="btn btn-dark" type="submit">
            <img src="/static/img/profile_icon.svg" alt=""> –í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button></a>

            {% else %}
            <div class="dropstart">
              <button class="btn btn-dark dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                {{ email }}
              </button>
              <ul class="dropdown-menu">
                <!-- <li><a class="dropdown-item" href="#">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li> -->
                <li><a class="dropdown-item" href="/register">–í—ã—Ö–æ–¥ –∏–∑ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</a></li>
              </ul>
            </div>
            {% endif %}
          </div>
        </div>
      </nav>

      <div class="colored-bg">

        <div>
          <table width="100%">
            <tr>
             <td width="15%">
              <form action="/redir/{{ holder }}">
                <button type="button submit" class="btn btn-success back-button">ü†î –ù–∞–∑–∞–¥</button>
              </form>
             </td>
             <td class="normal-text">
              <div class="adress-string">
                <img class="noselect" src="/static/img/folder.svg" width="30px", height="30px">
                {{ adress }}
              </div>
             </td>
            </tr>
          </table>
        

        <table class="file-table">
          <tr class="header">
            <th><br></th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th style="width: 200px;">–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞</th>
            <th>
            </th>
          </tr>

          {% if not search %}
            <tr class="add-file">
              <td colspan="4" class="add-file">
                <button type="button" class="btn transponent-btn" data-bs-toggle="modal" data-bs-target="#add-file">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª <img src="/static/img/plus.svg" alt="+"></button>
              </td>
            </tr>

            <tr class="add-rep">
              <td colspan="4" class="add-rep">
                <button type="button" class="btn transponent-btn" data-bs-toggle="modal" data-bs-target="#add-rep">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–∞–ø–∫—É <img src="/static/img/plus.svg" alt="+"></button>
              </td>
            </tr>
          {% endif %}
          
          {% for file in folder %}
          <tr class="file-row">
            <td>
              <img class="noselect" src="/static/img/folder.svg", style="width: 35px; height: 35px">
            </td>
            <td> {{ file[0] | safe }} </td>
            <td style="width: 100px;">
              <form action="/redir/{{ file[1] }}">
              <input type="submit" value="–û—Ç–∫—Ä—ã—Ç—å" /></form>
            </td>
            <td style="width: 50px;">
              <div class="dropup">
                <button class="btn transponent-btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <img class="noselect" src="/static/img/options_icon.svg">
                </button>
                <ul class="dropdown-menu">
                  <li><form action="/delete_folder/{{ file[1] }}">
                    <input type="submit" value="–£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É" />
                  </form></li>
                </ul>
              </div>
            </td>
          </tr>
          {% endfor %}

          {% for file in files %}
          <tr class="file-row">
            <td>
              <img class="noselect" src="/static/img/{{ file[0] }}">
            </td>
            <td> {{ file[1] | safe }}  </td>
            <td style="width: 100px;"> {{ file[2] }} </td>
            <td style="width: 50px;">
              <div class="dropup">
                <button class="btn transponent-btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <img class="noselect" src="/static/img/options_icon.svg">
                </button>
                <ul class="dropdown-menu">
                  <li>
                    <form action="/download/{{ file[3] }}">
                    <input type="submit" value="–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª" /></form>
                  </li>
                  <li><form action="/delete/{{ file[3] }}">
                    <input type="submit" value="–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª" />
                  </form></li>
                </ul>
              </div>
            </td>
          </tr>
          {% endfor %}

        </table>
      </div>

      </div>

      <div class="modal fade" id="add-file" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title noselect" id="staticBackdropLabel">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form action="" method="POST" enctype="multipart/form-data">
                <input type=file name=file multiple />
                
                <input type=submit value=–ó–∞–≥—Ä—É–∑–∏—Ç—å! id="btnFetch"><a id="loading"></a>
              </form>
            </div>
            <!-- <div style="margin:3em;">
              <form class="form-inline" id="topicForm" action="" method="POST">
                <button type="button" id="btnFetch" class="btn btn-primary mb-2">Submit</button>
              </form>
            </div> -->

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="add-rep" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title noselect" id="staticBackdropLabel">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∏</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="" method="POST" enctype=multipart/form-data id="add-rep">
                  <input id="email-login" class="form-control inline" name="email-login" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏">
                  <button type="button submit" class="btn btn-success gx-5">–°–æ–∑–¥–∞—Ç—å</button>
              </form>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

      <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
      <div class="modal fade" id="exampleModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="staticBackdropLabel">–£–ø—Å! –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
              {{ wrong_password }}
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-warning" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
      <script src="/static/js/popper.min.js" ></script>
      <script src="/static/js/bootstrap.min.js"></script>

      {% if wrong_password %}
        <script>
          var exampleModal = new bootstrap.Modal(document.getElementById('exampleModal'), {})
          exampleModal.show()
        </script>
      {% endif %}
      <script>
        $(document).ready(function() {
      $("#btnFetch").click(function() {
      $('#loading').html(
        `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>`
          );
        });
      });
      </script>
    
</body>
</html>